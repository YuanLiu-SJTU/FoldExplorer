# FoldExplorer
FoldExplorer: Fast and Accurate Protein Structure Search with Sequence-Enhanced Graph Embedding

## Preparation
FoldExplorer is implemented with Python3, so a Python3 (>=3.7) interpreter is required.
At first, download the source code of FoldExplorer from Github:
```bash
git clone https://github.com/YuanLiu-SJTU/FoldExplorer.git
```
Then, we recommend you to use a virtual environment, such as Anaconda, to install the dependencies of FoldExplorer:
``` bash
conda create -n FoldExplorer python=3.7
conda activate FoldExplorer
```
Pytorch is necessary and we recommend you to use GPU to accelerate the computation. If you use GPU, please install a gpu-based Pytorch and select the proper cudatoolkit version number that matches your platform. For example:
```bash
conda install pytorch==1.12.1 cudatoolkit=11.3 -c pytorch
```
If you do not want to use gpu, please isntall a cpu-only Pytorch.
```bash
conda install pytorch cpuonly -c pytorch
```
And then install other requirements simply run:
```bash
pip install -r requirements.txt
```
When you want to quit the virtual environment, just:
```bash
conda deactivate FoldExplorer
```

## Usage
### Generate descriptors for protein structures using FoldExplorer
If you only want to generate descriptors for protein structures, you can run the command as following
```
conda activate FoldExplorer
python extract.py -q examples
```
The program will automatically create a temporary folder ```./tmp/``` to store temporary files and an output folder ```./output/``` to store the results. More details can be seen by running:
```python
python extract.py -h
```
The format of descriptor files are end with ```.pkl``` in the ```output folder```. you can check it in python3 as following:
```bash
$ python3
>>> import pickle
>>> with open("output/descriptors.pkl", "rb") as p:
...     d = pickle.load(p)
...     print(d)
```
If the protein structure files are too many (>10,000), they will be divided into several small descriptor files. 

You can utilize descriptors generated by FoldExplorer to build your own database and perform protein structure comparisons and searches based on the cosine similarity between descriptors.


## License
### Code License
The code of FoldExplorer is under [CC BY-NC 4.0](https://github.com/YuanLiu-SJTU/FoldExplorer/blob/master/LICENSE). 

The moco.py is modified from 
[MoCo/builder.py](https://github.com/facebookresearch/moco/blob/master/moco/builder.py), 
which is under CC-BY-NC 4.0 license. The details can be referred from 
[MoCo_LICENSE](https://github.com/YuanLiu-SJTU/FoldExplorer/blob/master/MoCo_LICENSE).

### Model Parameters License
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />
The FoldExplorer parameters are made availabe under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.

## Online service
We also provide online retrieval service [here](http://www.csbio.sjtu.edu.cn/bioinf/FoldExplorer/).


